angular.module("datoniApp.services").service("Cart",function(e,t,n,i,r){var s=function(){return this.items=[],this};s.prototype.hasItem=function(e){var t=!1;return t},s.prototype.addItem=function(e,n){var i=this.hasItem(e);if(i)this.changeQuantity(e,++e.quantity);else{if("undefined"==typeof e.price){var r=e.prices[0];null===r.price&&(e.prices.shift(),r=e.prices[0])}else r=e.price;for(var s=[],a=[],o=Object.keys(e.ingredients),u=0,c=o.length;c>u;u++){var p=o[u],g=e.ingredients[p];1!=n&&5!=n&&3!=n&&4!=n||"undefined"==typeof e.defaultIngredients||-1!=e.defaultIngredients.indexOf(p)?(1==n||5==n||3==n||4==n)&&"undefined"!=typeof e.defaultIngredients&&e.defaultIngredients.indexOf(p)>-1&&(g||s.push(p)):g&&a.push(p)}e=angular.copy(e),"undefined"!=typeof e.dressing&&e.dressing&&(e.name+=" ("+e.dressing+")"),this.items.push({sid:+new Date,category:n,product:e,ingredients:e.ingredients,addedIngredients:a,removedIngredients:s,quantity:1,size:r.size,price:r.price}),d(e.name+" hinzugefügt","ion-checkmark-circled")}t.badge.cart=this.items.length};var d=function(e,t){var n=i.show({title:e,template:'<i class="ion '+t+' dialog-icon"></i>',cssClass:"dialog-popup"});r(function(){n.close()},1e3)};return s.prototype.clear=function(){this.items=[]},s.prototype.changeQuantity=function(e,t){newItems=[],1>t||t>9||(angular.forEach(this.items,function(n){n.product.number===e.product.number&&n.sid===e.sid&&(n.quantity=t),newItems.push(n)}),this.items=newItems)},s.prototype.getNumber=function(){return this.items.length},s.getPrice=function(e){if("undefined"==typeof e.addedIngredients||0==e.addedIngredients.length)return e.price;for(var t=e.price,n=.5,i=e.product.prices,r=0,s=i.length;s>r;r++)if(i[r].price==e.price)var d=i[r].size;switch(d){case"klein":n=.5;break;case"gross":n=1;break;case"familie":n=1.5;break;default:n=1}return t+e.addedIngredients.length*n},s.prototype.getPostData=function(){return this.items.map(function(e){return{product:e.product,size:e.size,quantity:e.quantity,price:s.getPrice(e),addedIngredients:e.addedIngredients,removedIngredients:e.removedIngredients}})},s.prototype.removeItem=function(e){newItems=[],angular.forEach(this.items,function(t){(t.product.number!==e.product.number||t.sid!==e.sid)&&newItems.push(t)}),this.items=newItems;try{alertify.error(item.name+" hinzugefügt")}catch(n){}t.badge.cart=this.items.length},s.prototype.checkout=function(){},s});